<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Displaying your printer’s status (2012) - Michael Stapelberg</title>

  <meta property="og:site_name" content="Michael Stapelberg">
  <meta property="og:title" content="Displaying your printer’s status">
  <meta property="og:description" content="At our house, we have a single, high-quality laser color printer in the basement (along with the other computer equipment) which everybody uses, as opposed to a crappy cheap printer at everyone’s workplace. This is a great setup in our situation, since nobody prints a lot individually, so the slight discomfort of having to go to the basement is a welcome trade-off for not having to maintain cheap printers.">
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/favicon-48x48.png" sizes="48x48">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <meta name="description" content="At our house, we have a single, high-quality laser color printer in the basement (along with the other computer equipment) which everybody uses, as opposed to a crappy cheap printer at everyone’s workplace. This is a great setup in our situation, since nobody prints a lot individually, so the slight discomfort of having to go to the basement is a welcome trade-off for not having to maintain cheap printers.">
  <link rel="canonical" href="https://michael.stapelberg.ch/posts/2012-10-28-printer_status/">
  <meta name="author" content="Michael Stapelberg">
  <style type="text/css">
    @font-face {
	font-family: 'Roboto Mono';
	src: url('/font/subset-RobotoMono-Regular.eot');
	src: local('Roboto Mono Regular'), local('RobotoMono-Regular'),
        url('/font/subset-RobotoMono-Regular.eot?#iefix') format('embedded-opentype'),
        url('/font/subset-RobotoMono-Regular.woff2') format('woff2'),
        url('/font/subset-RobotoMono-Regular.woff') format('woff'),
        url('/font/subset-RobotoMono-Regular.ttf') format('truetype');
	font-weight: normal;
	font-style: normal;
	font-display: swap;
    }

    @font-face {
	font-family: 'Roboto';
	src: url('/font/subset-Roboto-Bold.eot');
	src: local('Roboto Bold'), local('Roboto-Bold'),
        url('/font/subset-Roboto-Bold.eot?#iefix') format('embedded-opentype'),
        url('/font/subset-Roboto-Bold.woff2') format('woff2'),
        url('/font/subset-Roboto-Bold.woff') format('woff'),
        url('/font/subset-Roboto-Bold.ttf') format('truetype');
	font-weight: bold;
	font-style: normal;
	font-display: swap;
    }

    @font-face {
	font-family: 'Roboto';
	src: url('/font/subset-Roboto-Regular.eot');
	src: local('Roboto'), local('Roboto-Regular'),
        url('/font/subset-Roboto-Regular.eot?#iefix') format('embedded-opentype'),
        url('/font/subset-Roboto-Regular.woff2') format('woff2'),
        url('/font/subset-Roboto-Regular.woff') format('woff'),
        url('/font/subset-Roboto-Regular.ttf') format('truetype');
	font-weight: normal;
	font-style: normal;
	font-display: swap;
    }

    @font-face {
	font-family: 'Lato';
	src: url('/font/subset-Lato-Bold.eot');
	src: local('Lato Bold'), local('Lato-Bold'),
        url('/font/subset-Lato-Bold.eot?#iefix') format('embedded-opentype'),
        url('/font/subset-Lato-Bold.woff2') format('woff2'),
        url('/font/subset-Lato-Bold.woff') format('woff'),
        url('/font/subset-Lato-Bold.ttf') format('truetype');
	font-weight: bold;
	font-style: normal;
	font-display: swap;
    }

    body, td, th {
	font-family: 'Roboto';
	font-size: 16px;
	line-height: 150%;
	color: #000;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
	font-family: 'Lato';
	font-weight: bold;
	font-variant-ligatures: none;
	color: #000;
    }
  </style>

  
  <link rel="preload" href="/font/subset-Lato-Bold.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/font/subset-Roboto-Regular.woff2" as="font" type="font/woff2" crossorigin>
  
  <link rel="stylesheet" href="/1.min.css" type="text/css">
  <link rel="alternate" href="/feed.xml" type="application/atom+xml" title="ATOM feed">
</head>
<body>



<header id="ms_navbar">
  <a href="/">
<img
    src="/logo1x.jpg"
    srcset="/logo2x.jpg 2x, /logo3x.jpg 3x"
    width="42"
    height="52"
    alt="profile picture"
    title="profile picture">
</a>
  <div>
    <a href="/"><h1>Michael Stapelberg</h1></a>
    <nav id="ms_desktopnav">
      <ul>
	
    <li><a href="/" >About</a></li>
    <li><a href="/posts/" class="active">Blog</a></li>
    <li><a href="/talks/" >Talks</a></li>
    <li><a href="/series/" >Series</a></li>

      </ul>
    </nav>
  </div>

  <div id="ms_burger_open">
    <label for="ms_burger"><svg viewBox="0 0 100 80" width="24" height="24">
	<rect width="100" height="17" rx="8" fill="white"></rect>
	<rect y="30" width="100" height="17" rx="8" fill="white"></rect>
	<rect y="60" width="100" height="17" rx="8" fill="white"></rect>
    </svg></label>
  </div>

  <input type="checkbox" id="ms_burger">

  <nav id="ms_navdrawer">
    <div id="ms_navdrawer_top">
      <div id="ms_navdrawer_search">
	<a href="/">
<img
    src="/logo1x.jpg"
    srcset="/logo2x.jpg 2x, /logo3x.jpg 3x"
    width="42"
    height="52"
    alt="profile picture"
    title="profile picture">

	<h1>Michael Stapelberg</h1></a>
      </div>
      <div id="ms_burger_close">
	<label for="ms_burger"><svg viewBox="0 0 110 110" width="24" height="24">
	    <line x1="10" y1="10" x2="100" y2="100" stroke="#047bc2" stroke-width="20" />
	    <line x1="100" y1="10" x2="10" y2="100" stroke="#047bc2" stroke-width="20" />
	</svg></label>
      </div>
    </div>

    <div id="ms_navdrawer_content">
      <ul>
	
    <li><a href="/" >About</a></li>
    <li><a href="/posts/" class="active">Blog</a></li>
    <li><a href="/talks/" >Talks</a></li>
    <li><a href="/series/" >Series</a></li>

      </ul>
    </div>
  </nav>
</header>
<main>
      <div>
<h1 class="ms_title">Displaying your printer’s status (2012)</h1>

<div class="ms_meta">
  <div id="ms_date">published 2012-10-28, last modified 2018-03-18</div>
  
  
  <div>
    <a href="https://github.com/stapelberg/hugo/edit/master/content/posts/2012-10-28-printer_status.markdown"><img src="/Bilder/pen-square-solid.svg" width="18" height="20" alt="Edit Icon" title="Suggest a change to this article"></a>
  </div>
  
</div>
<div class="Artikel" id="content">
  <p>
At our house, we have a single, high-quality laser color printer in the
basement (along with the other computer equipment) which everybody uses, as
opposed to a crappy cheap printer at everyone’s workplace. This is a great
setup in our situation, since nobody prints a lot individually, so the slight
discomfort of having to go to the basement is a welcome trade-off for not
having to maintain cheap printers.
</p>
<p>
The only problem with this is the lack of feedback from the printer. That is,
when you printed your document from, say, your web browser, you have no way of
knowing when printing finished. Sure, you could go to the CUPS print server and
repeatedly watch to know when CUPS finished spooling the job. But that’s rather
inconvenient and won’t tell you what’s wrong in case the printer does
<strong>not</strong> print as expected (it will just sit there, or be paused).
</p>
<p>
What happened in reality is that I send the print job, wait a certain amount of
time (roughly corresponding with the document size) and just walk into the
basement. That usually works, except when it doesn’t.
</p>
<p>
Therefore, I wrote a little script which will display the printer’s status
(effectively what it displays on the LCD) using a Freedesktop notification
whenever the status changes. It looks like this in action:
</p>
<img src="/Bilder/printer-status.png" alt="printer status screenshot" width="358" height="38">
<p>
…where "kyocera" is the hostname of the printer and "Es wird gedruckt" is the
german way of saying "printing". The program displaying the notification is <a
href="http://knopwob.github.com/dunst/">dunst, a dmenu-ish
notification-daemon</a> which I can recommend.
</p>
<p>
You can find <a
href="http://code.stapelberg.de/git/notify-printer-status/tree/notify-printer-status">the
script called notify-printer-status here</a> (how creative, eh?). Since the
source code is only 44 lines long (including comments and boilerplate), adding
configuration logic seems to be overkill. Instead, just modify your copy of it.
I’ve been using the script since over a month and it’s been working fine, so I
doubt there are any serious bugs in the code.
</p>
<p>
To use it, you first need an SNMP-capable printer (doh). Then, install the Perl
modules Net::SNMP and Desktop::Notify (<code>sudo apt-get install
libnet-snmp-perl libdesktop-notify-perl</code> on Debian). Now replace the
hostname and find out the SNMP OID for your printer. This is surprisingly hard,
but one way I’ve found to work well for me is to use snmpwalk, distributed as
an example with Net::SNMP, and grep for what the printer currently displays:
</p>
<pre>
$ zcat /usr/share/doc/libnet-snmp-perl/examples/snmpwalk.pl.gz > snmapwalk.pl
$ perl snmapwalk.pl kyocera.rag.lan | grep Ruhemodus
1.3.6.1.2.1.43.16.5.1.2.1.1 = OCTET STRING: Ruhemodus
</pre>
<p>
Afterwards, just start the script in your <code>~/.xsession</code> and forget
about it. Enjoy!
</p>

</div>

      </div>

    </main><div id="ms_footer">
  © 2023 Michael Stapelberg • all articles under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons CC-BY license</a>
</div>
</body>
</html>
