<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Survey answers part 2: the transition (2013) - Michael Stapelberg</title>

  <meta property="og:site_name" content="Michael Stapelberg">
  <meta property="og:title" content="Survey answers part 2: the transition">
  <meta property="og:description" content="This blog post is the second of a series of posts dealing with the results of the Debian systemd survey. I intend to give a presentation at DebConf 2013, too, so you could either read my posts, or watch the talk, or both :-).">
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/favicon-48x48.png" sizes="48x48">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <meta name="description" content="This blog post is the second of a series of posts dealing with the results of the Debian systemd survey. I intend to give a presentation at DebConf 2013, too, so you could either read my posts, or watch the talk, or both :-).">
  <link rel="canonical" href="https://michael.stapelberg.ch/posts/2013-07-01-systemd-transition/">
  <meta name="author" content="Michael Stapelberg">
  <style type="text/css">
    @font-face {
	font-family: 'Roboto Mono';
	src: url('/font/subset-RobotoMono-Regular.eot');
	src: local('Roboto Mono Regular'), local('RobotoMono-Regular'),
        url('/font/subset-RobotoMono-Regular.eot?#iefix') format('embedded-opentype'),
        url('/font/subset-RobotoMono-Regular.woff2') format('woff2'),
        url('/font/subset-RobotoMono-Regular.woff') format('woff'),
        url('/font/subset-RobotoMono-Regular.ttf') format('truetype');
	font-weight: normal;
	font-style: normal;
	font-display: swap;
    }

    @font-face {
	font-family: 'Roboto';
	src: url('/font/subset-Roboto-Bold.eot');
	src: local('Roboto Bold'), local('Roboto-Bold'),
        url('/font/subset-Roboto-Bold.eot?#iefix') format('embedded-opentype'),
        url('/font/subset-Roboto-Bold.woff2') format('woff2'),
        url('/font/subset-Roboto-Bold.woff') format('woff'),
        url('/font/subset-Roboto-Bold.ttf') format('truetype');
	font-weight: bold;
	font-style: normal;
	font-display: swap;
    }

    @font-face {
	font-family: 'Roboto';
	src: url('/font/subset-Roboto-Regular.eot');
	src: local('Roboto'), local('Roboto-Regular'),
        url('/font/subset-Roboto-Regular.eot?#iefix') format('embedded-opentype'),
        url('/font/subset-Roboto-Regular.woff2') format('woff2'),
        url('/font/subset-Roboto-Regular.woff') format('woff'),
        url('/font/subset-Roboto-Regular.ttf') format('truetype');
	font-weight: normal;
	font-style: normal;
	font-display: swap;
    }

    @font-face {
	font-family: 'Lato';
	src: url('/font/subset-Lato-Bold.eot');
	src: local('Lato Bold'), local('Lato-Bold'),
        url('/font/subset-Lato-Bold.eot?#iefix') format('embedded-opentype'),
        url('/font/subset-Lato-Bold.woff2') format('woff2'),
        url('/font/subset-Lato-Bold.woff') format('woff'),
        url('/font/subset-Lato-Bold.ttf') format('truetype');
	font-weight: bold;
	font-style: normal;
	font-display: swap;
    }

    body, td, th {
	font-family: 'Roboto';
	font-size: 16px;
	line-height: 150%;
	color: #000;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
	font-family: 'Lato';
	font-weight: bold;
	font-variant-ligatures: none;
	color: #000;
    }
  </style>

  
  <link rel="preload" href="/font/subset-Lato-Bold.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/font/subset-Roboto-Regular.woff2" as="font" type="font/woff2" crossorigin>
  
  <link rel="stylesheet" href="/1.min.css" type="text/css">
  <link rel="alternate" href="/feed.xml" type="application/atom+xml" title="ATOM feed">
</head>
<body>



<header id="ms_navbar">
  <a href="/">
<img
    src="/logo1x.jpg"
    srcset="/logo2x.jpg 2x, /logo3x.jpg 3x"
    width="42"
    height="52"
    alt="profile picture"
    title="profile picture">
</a>
  <div>
    <a href="/"><h1>Michael Stapelberg</h1></a>
    <nav id="ms_desktopnav">
      <ul>
	
    <li><a href="/" >About</a></li>
    <li><a href="/posts/" class="active">Blog</a></li>
    <li><a href="/talks/" >Talks</a></li>
    <li><a href="/series/" >Series</a></li>

      </ul>
    </nav>
  </div>

  <div id="ms_burger_open">
    <label for="ms_burger"><svg viewBox="0 0 100 80" width="24" height="24">
	<rect width="100" height="17" rx="8" fill="white"></rect>
	<rect y="30" width="100" height="17" rx="8" fill="white"></rect>
	<rect y="60" width="100" height="17" rx="8" fill="white"></rect>
    </svg></label>
  </div>

  <input type="checkbox" id="ms_burger">

  <nav id="ms_navdrawer">
    <div id="ms_navdrawer_top">
      <div id="ms_navdrawer_search">
	<a href="/">
<img
    src="/logo1x.jpg"
    srcset="/logo2x.jpg 2x, /logo3x.jpg 3x"
    width="42"
    height="52"
    alt="profile picture"
    title="profile picture">

	<h1>Michael Stapelberg</h1></a>
      </div>
      <div id="ms_burger_close">
	<label for="ms_burger"><svg viewBox="0 0 110 110" width="24" height="24">
	    <line x1="10" y1="10" x2="100" y2="100" stroke="#047bc2" stroke-width="20" />
	    <line x1="100" y1="10" x2="10" y2="100" stroke="#047bc2" stroke-width="20" />
	</svg></label>
      </div>
    </div>

    <div id="ms_navdrawer_content">
      <ul>
	
    <li><a href="/" >About</a></li>
    <li><a href="/posts/" class="active">Blog</a></li>
    <li><a href="/talks/" >Talks</a></li>
    <li><a href="/series/" >Series</a></li>

      </ul>
    </div>
  </nav>
</header>
<main>
      <div>
<h1 class="ms_title">Survey answers part 2: the transition (2013)</h1>

<div class="ms_meta">
  <div id="ms_date">published 2013-07-01, last modified 2019-02-04</div>
  
  
  <div id="ms_tags">
  
  in tag
  
  
  <span class="ms_tag"><a href="/posts/tags/debian/">debian</a></span>
  
  </div>
  
  <div>
    <a href="https://github.com/stapelberg/hugo/edit/master/content/posts/2013-07-01-systemd-transition.html"><img src="/Bilder/pen-square-solid.svg" width="18" height="20" alt="Edit Icon" title="Suggest a change to this article"></a>
  </div>
  
</div>
<div class="Artikel" id="content">
  <p>
This blog post is the second of a series of posts dealing with the results of <a
href="http://people.debian.org/~stapelberg//2013/05/27/systemd-survey-results.html">the
Debian systemd survey</a>. I intend to give a presentation at DebConf 2013,
too, so you could either read my posts, or watch the talk, or both :-).
</p>

<p>
It seems that it is unclear how Debian’s transition to systemd is intended to
work. By “transition”, we mean going from the current state (sysvinit is the
default and fully supported) to <i>systemd is fully supported</i>. Then by
merely installing systemd by default and letting it provide
<code>/sbin/init</code>, we can make it the default init system. If and when
that happens is a different matter and it’s not necessary for all packages to
have systemd support.
</p>

<h3>sysvinit compatibility</h3>

<p>
systemd natively supports sysvinit scripts, meaning your existing package will work as-is — but you cannot utilize all the features that systemd provides. The sysvinit support works very well, as you can try in a fresh Debian wheezy VM. In the output of “systemctl list-units”, every entry which has an “LSB: ” prefix is actually a sysvinit script.
</p>

<p>
The mechanism with which systemd decides whether to use an init script or a
service file is by looking whether a service file with a corresponding name
exists. That is, if e.g. <code>apache2.service</code> exists, systemd will
prefer it over <code>/etc/init.d/apache2</code>.
</p>

<p>
To make this crystal clear: it is not necessary to ship service files for all
services in some kind of <a
href="http://en.wikipedia.org/wiki/Flag_day_%28software%29">flag day</a>.
systemd supports a “mixed” installation where some services use init scripts
and some services use service files.
</p>

<h3>Adding systemd support to your package</h3>

<p>
In a nutshell, it usually works like this:
</p>

<ol>
<li>
Install a service file to <code>/lib/systemd/system/foo.service</code>.<br>
Often, upstream already provides and installs a <code>.service</code> file.<br>
If not, you can place your file at <code>debian/package.service</code><br>
Make sure that your service file name corresponds to the sysvinit script name<br>
(e.g. <code>apache2.service</code> for <code>/etc/init.d/apache2</code>)
</li>

<li>
Ensure your service file(s) are enabled and started.<br>
We strongly recommend you to use our package dh-systemd.<br>
If you use <a href="http://joeyh.name/blog/entry/cdbs_killer___40__design_phase__41__/">dh(1)</a>, add <code>--with=systemd</code> in <code>debian/rules</code> and Build-Dep on dh-systemd
</li>

<li>
Test your package, see the next section.
</li>
</ol>

<p>
For details see <a href="http://wiki.debian.org/Systemd/Packaging">wiki.debian.org/Systemd/Packaging</a>.
</p>

<h3>Testing systemd</h3>

<p>
We carefully made sure that you can install the systemd Debian package on your
machine alongside sysvinit without breaking anything. The systemd package does
not conflict with any other packages, it will not replace
<code>/sbin/init</code> and systemd will not be enabled right away. It is only
after you specify the kernel parameter <code>init=/bin/systemd</code> in
<code>/etc/default/grub</code> that you switch to systemd. In case you want to
go back, simply boot without this kernel parameter.
</p>

<h3>Conclusion</h3>

<p>
In conclusion, the transition is straight-forward and the necessary
infrastructure is in place. systemd is available in Debian and can be used
today. Packages can add systemd support whenever their maintainer(s) feel like
it. There is no need for a <a
href="http://en.wikipedia.org/wiki/Flag_day_%28software%29">flag day</a>. We
can switch the default whenever we think we are ready.
</p>

</div>

      </div>

    </main><div id="ms_footer">
  © 2023 Michael Stapelberg • all articles under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons CC-BY license</a>
</div>
</body>
</html>
